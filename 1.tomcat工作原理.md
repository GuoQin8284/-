## 1.tomcat工作原理

##### 目录结构

bin 启动/停止文件

conf：配置文件

lib：运行的相关的库文件

logs：日志文件

tmp：临时文件

webapps：放站点文件

work：编译后产生的class的文件

##### 工作原理

server 相当于tomcat的实例

1.客户端向服务器发请求到连接器（connector）

2.连接器，默认的端口号是8080，连接器一般有2种：http，ajp

3.连接器将请求发送给引擎（engine）

4.将访问的资源解析到我们的虚拟主机host

5.匹配虚拟主机

6.通过context获取请求，并通过mapping table找到对应的servlet

7.封装request和response，并返回

servlet：server applet   是以serlet的编码方式写的一个tomcat的服务器端

## 2.tomcat监控

staus监控步骤：

1.配置用户及角色

配置用户角色的目的是为配置登录监控界面的用户，角色相当于权限

配置文件conf/tomcat-user.xml

配置的用户名可以随便起

角色：admin-gui   manager-gui

```
<user username="test" password="test" roles="admin-gui,manager-gui"/>
```

2.重启服务器

3.进入监控页

```
http://localhost:8080/manager/html
```



# 1.Tomcat基础

1.1 web基础

```
（1）软件架构
	1. C/S架构：客户端/服务器端
	2. B/S架构：浏览器/服务器端
	
（2）资源分类
	1.静态资源：所有用户访问后，得到的结果都是一样的，成为静态资源，静态资源可以直接被浏览器解析。如：html、css、JavaScript、jgp
	2.动态资源：每个用户访问相同资源后，得到的结果可能不一样，成为动态资源。动态资源被访问后，需要先转换为静态资源，再返回给浏览器，通过浏览器进行解析。如：servlet、jsp、php、asp。。。。。
（3）网络通信三要素
	1. IP：电子设备（计算机）在网络上的唯一标识
	2. 端口：应用程序在计算机中的唯一表示。
	3. 传输协议：规定了数据传输的规则
		1. tcp：安全协议，三次握手，速度稍慢
		2. udp：不安全的协议，速度快
```

1.2 常见的web服务器

1.2.1 概念

```
（1）服务器：安装了服务器软件的计算机
（2）服务器的软甲：接收用户的请求，处理请求，做出响应
（3）web服务器软件：接收用户的请求，处理请求，做出响应。
	在web服务器中，可以部署web项目，让用户通过浏览器来访问这些项目
```

1.2.2常见的web服务器软件

```
（1）webLogic：oracle公司，大型的JavaEE服务器，支持所有的javaEE规范，收费的
（2）webSphere：IBM公司，大型的JavaEE服务器，支持所有的javaEE规范，收费的
（3）JBOSS：JBOSS公司，大型的JavaEE服务器，支持所有的javaEE规范，收费的
（4）Tomcat：Apache基金组织，中小型的JavaEE服务器，仅仅支持少量的JavaEE规范servlet/jsp，开源的，免费的
```

# 2.Tomcat架构

2.1 Http工作原理

http协议是浏览器与服务器的数据传输协议。作为应用层协议，HTTP是基于TCP/IP协议来传递数据的（HTML文件、图片、查询结果等），HTTP协议不涉及数据包（Packet）传输，主要规定了客户端和服务器之间的通信格式。

![image-20200317233559818](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200317233559818.png)

这个过程是：

（1）用户通过浏览器进行了一个操作，比如输入网址并回车，或者是点击链接，这里浏览器获取这个事件。

（2）浏览器向服务器发出TCP请求

（3）服务程序接受浏览器的链接请求，并经过TCP三次握手建立链接。

（4）浏览器将请求数据打包成一个HTTP协议格式的数据包。

（5）浏览器将该数据包推入网络，数据包经过网络传输，最终到达服务端程序

（6）服务器程序拿到这个数据包后，同样以HTTP协议格式解包，获取到客户端的意图

（7）得知客户端意图后进行处理，比如提供静态文件或者调用服务端程序获得动态效果

（8）服务端将响应结果（可能是HTML或者图片等）按照HTTP洗衣协议格式打包

（9）服务器将响应数据包推入网络，数据包经过网络传输最终到达浏览器

（10）浏览器拿到数据包后，以HTTP协议的格式解包，然后解析数据，假设这里的数据是HTML

（11）浏览器将HTML文件展示在页面上

Tomcat和Jetty作为一个HTTP服务器，在这个过程中只要是接受连接、解析请求数据、处理请求数据和发送响应这几个步骤。